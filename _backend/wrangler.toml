name = "programprimitives-api"
main = "./build/worker.mjs"
compatibility_date = "2024-01-01"

[build]
command = "go run github.com/syumai/workers/cmd/workers-assets-gen@latest && GOOS=js GOARCH=wasm go build -o ./build/app.wasm ./cmd/api && wasm-opt -Os ./build/app.wasm -o ./build/app.wasm || true"

[[d1_databases]]
binding = "DB"
database_name = "programprimitives-db"
database_id = "YOUR_DATABASE_ID"

[[kv_namespaces]]
binding = "KV"
id = "YOUR_KV_NAMESPACE_ID"

[vars]
ENVIRONMENT = "development"
JWT_SECRET = "change-this-in-production"
CORS_ORIGIN = "http://localhost:5173"

[env.staging]
vars = { ENVIRONMENT = "staging", CORS_ORIGIN = "https://staging.programprimitives.com" }

[env.production]
vars = { ENVIRONMENT = "production", CORS_ORIGIN = "https://programprimitives.com" }

